webpackJsonp([94],{1616:function(t,e,a){"use strict";var s=a(730),n=a(433);e.a={mixins:[s.a,n.a],data:function(){return{show_form:!1,cfg_name:"storage",config:{access_key:"",secret_key:"",bucket:"",prefix:"",domain:""}}}}},2504:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-grid"},[a("Card",{attrs:{"dis-hover":""}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("a",{attrs:{href:"https://portal.qiniu.com/signup?code=3laiccx4xi6he",target:"_blank"}},[t._v("七牛")]),t._v("云存储配置\n\t        ")]),t._v(" "),a("Alert",{directives:[{name:"show",rawName:"v-show",value:""==t.config.access_key||t.show_form,expression:"config.access_key == '' || show_form"}],attrs:{"show-icon":""}},[t._v("\n\t\t        云存储开通说明\n\t\t        "),a("Icon",{attrs:{slot:"icon",type:"ios-lightbulb-outline"},slot:"icon"}),t._v(" "),a("template",{slot:"desc"},[t._v("\n\t\t        \t系统默认赠送 "),a("Tag",{attrs:{color:"red"}},[t._v("2G")]),t._v(" 的云存储空间，用于存放所有的上传文件附件包括图像、语音、小视频等。\n\t\t        \t"),a("br"),t._v("\n\t\t        \t您可以"),a("Tag",{attrs:{color:"blue"}},[t._v("免费")]),t._v("的开通七牛云存储，获取更多的存放空间，并且文件存储在您自己的云存储账号上面。\n\t\t        \t"),a("br"),t._v("\n\t\t        \t您需要 "),a("a",{attrs:{target:"_blank",href:"https://portal.qiniu.com/signup?code=3laiccx4xi6he"}},[t._v("先前往申请")]),t._v(" 账号，如果您已经有七牛云存储账号，只需将相关云存储的配置信息填写到下面的配置表格即可。\n\t\t        \t"),a("br"),t._v("\n\t\t        \t如果您在操作上有任何疑问，可以与我们的客服联系，获取更多帮助。\n\t\t        \t"),a("br"),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.show_form=!0}}},[t._v("我要使用自己的云存储账号")])],1)],2),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.config.domain||t.show_form,expression:"config.domain != '' || show_form"}]},[a("Form",[a("Form-item",{attrs:{label:"AccessKey"}},[a("Input",{attrs:{placeholder:"请输入AK"},model:{value:t.config.access_key,callback:function(e){t.$set(t.config,"access_key",e)},expression:"config.access_key"}})],1),t._v(" "),a("Form-item",{attrs:{label:"SecretKey"}},[a("Input",{attrs:{placeholder:"请输入SK"},model:{value:t.config.secret_key,callback:function(e){t.$set(t.config,"secret_key",e)},expression:"config.secret_key"}})],1),t._v(" "),a("Form-item",{attrs:{label:"Bucket"}},[a("Input",{attrs:{placeholder:"Bucket"},model:{value:t.config.bucket,callback:function(e){t.$set(t.config,"bucket",e)},expression:"config.bucket"}})],1),t._v(" "),a("Form-item",{attrs:{label:"资源前缀"}},[a("Input",{attrs:{placeholder:"资源前缀"},model:{value:t.config.prefix,callback:function(e){t.$set(t.config,"prefix",e)},expression:"config.prefix"}})],1),t._v(" "),a("Form-item",{attrs:{label:"访问域名"}},[a("Input",{attrs:{placeholder:"访问域名"},model:{value:t.config.domain,callback:function(e){t.$set(t.config,"domain",e)},expression:"config.domain"}})],1)],1),t._v(" "),a("div",{staticClass:"footer-btn",staticStyle:{"padding-left":"0"}},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit()}}},[t._v("保存配置")])],1)],1)],1)],1)},n=[];s._withStripped=!0;var o={render:s,staticRenderFns:n};e.a=o},418:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(1616),n=a(2504),o=a(8),r=o(s.a,n.a,!1,null,null,null);r.options.__file="src/views/system/configs/storage.vue",e.default=r.exports},432:function(t,e,a){"use strict";e.__esModule=!0;var s=a(446),n=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default=function(t,e,a){return e in t?(0,n.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},433:function(t,e,a){"use strict";var s,n=a(21),o=a.n(n),r=a(432),i=a.n(r),c=a(47),u=(a(4),a(7));e.a={filters:(s={branch_name:function(t,e,a){var s="",n=c.a.getters.getGlobalVar("branchs");if(n)for(var o=0,r=n.length;o<r;o++)if(t==n[o].bid){s=n[o].short_name||n[o].branch_name;break}return s},class_name:function(t){return c.a.getters.getMapText(t,"classes")}},i()(s,"branch_name",function(t,e){if(c.a.state.maps.branch||(c.a.state.maps.branch={},c.a.state.maps.branch_object={}),c.a.state.maps.branch[t])return c.a.state.maps.branch[t];var a=c.a.state.gvars.branchs.find(function(e){return e.bid==t});return a?(c.a.state.maps.branch[t]=a.branch_name,c.a.state.maps.branch_object[t]=a,a.branch_name):e||t}),i()(s,"dpt_name",function(t,e){if(c.a.state.maps.department||(c.a.state.maps.department={},c.a.state.maps.department_object={}),c.a.state.maps.department[t])return c.a.state.maps.department[t];var a=c.a.state.gvars.departments.find(function(e){return e.dpt_id==t});return a?(c.a.state.maps.department[t]=a.dpt_name,c.a.state.maps.department_object[t]=a,a.dpt_name):e||t}),i()(s,"role_name",function(t,e){if(c.a.state.maps.role||(c.a.state.maps.role={},c.a.state.maps.role_object={}),c.a.state.maps.role[t])return c.a.state.maps.role[t];var a=c.a.state.gvars.roles.find(function(e){return e.rid==t});return a?(c.a.state.maps.role[t]=a.role_name,c.a.state.maps.role_object[t]=a,a.role_name):e||t}),i()(s,"ename",function(t,e){if(c.a.state.maps.employee||(c.a.state.maps.employee={},c.a.state.maps.employee_object={}),c.a.state.maps.employee[t])return c.a.state.maps.employee[t];var a=c.a.state.gvars.employees.find(function(e){return e.eid==t});return a?(c.a.state.maps.employee[t]=a.ename,c.a.state.maps.employee_object[t]=a,a.ename):e||t}),i()(s,"employee_name",function(t,e){if(c.a.state.maps.employee||(c.a.state.maps.employee={},c.a.state.maps.employee_object={}),c.a.state.maps.employee[t])return c.a.state.maps.employee[t];var a=c.a.state.gvars.employees.find(function(e){return e.eid==t});return a?(c.a.state.maps.employee[t]=a.ename,c.a.state.maps.employee_object[t]=a,a.ename):e||t}),i()(s,"lesson_name",function(t,e){if(c.a.state.maps.lesson||(c.a.state.maps.lesson={},c.a.state.maps.lesson_object={}),c.a.state.maps.lesson[t])return c.a.state.maps.lesson[t];var a=c.a.state.gvars.lessons.find(function(e){return e.lid==t});return a?(c.a.state.maps.lesson[t]=a.lesson_name,c.a.state.maps.lesson_object[t]=a,a.lesson_name):e||"-"}),i()(s,"lesson_no",function(t){if(c.a.state.maps.lesson_object||(c.a.state.maps.lesson={},c.a.state.maps.lesson_object={}),c.a.state.maps.lesson_object[t])return c.a.state.maps.lesson_object[t].lesson_no;var e=c.a.state.gvars.lessons.find(function(e){return e.lid==t});return e?(c.a.state.maps.lesson[t]=e.lesson_name,c.a.state.maps.lesson_object[t]=e,e.lesson_no):""}),i()(s,"subject_name",function(t,e){if(c.a.state.maps.subject||(c.a.state.maps.subject={},c.a.state.maps.subject_object={}),c.a.state.maps.subject[t])return c.a.state.maps.subject[t];var a=c.a.state.gvars.subjects.find(function(e){return e.sj_id==t});return a?(c.a.state.maps.subject[t]=a.subject_name,c.a.state.maps.subject_object[t]=a,a.subject_name):(0==t&&(t="-"),e||t)}),i()(s,"classroom_name",function(t,e){if(c.a.state.maps.classroom||(c.a.state.maps.classroom={},c.a.state.maps.classroom_object={}),c.a.state.maps.classroom[t])return c.a.state.maps.classroom[t];var a=c.a.state.gvars.classrooms.find(function(e){return e.cr_id==t});return a?(c.a.state.maps.classroom[t]=a.room_name,c.a.state.maps.classroom_object[t]=a,a.room_name):e||t}),i()(s,"season_name",function(t){var e=c.a.state.gvars.dicts.season,a=e.find(function(e){return e.name==t});return a?a.title:t}),i()(s,"dict_title",function(t,e,a){var s=c.a.state.gvars.dicts[e],n=s.find(function(e){return e.did==t});return"grade"==e&&(n=s.find(function(e){return e.name==t})),n?n.title:a}),i()(s,"lesson_status_text",function(t){return 2==t?"已结课":"正常"}),i()(s,"stop_status_text",function(t){return 1==t?"已停课":"正常"}),i()(s,"sj_ids_text",function(t,e){var a=[];return c.a.state.maps.subject||(c.a.state.maps.subject={},c.a.state.maps.subject_object={}),t.forEach(function(t){if(t=parseInt(t),c.a.state.maps.subject[t])return void a.push(c.a.state.maps.subject[t]);var e=c.a.state.gvars.subjects.find(function(e){return e.sj_id==t});e&&(c.a.state.maps.subject[t]=e.subject_name,c.a.state.maps.subject_object[t]=e,a.push(e.subject_name))}),a.join(",")}),s),methods:{initGlobal:function(t){var e=this;return new o.a(function(a,s){void 0===e.$store.state.gvars[t]?e.$store.dispatch("updateGlobalVar",t).then(function(t){a(t)},function(t){s(t)}):a(e.$store.state.gvars[t])})},initDictList:function(t,e,a){var s=this;return new o.a(function(n,o){void 0===s.$store.state.dicts[e]||!0===a?s.$store.dispatch("updateDictList",{url:t,dname:e}).then(function(t){n(t)},function(t){o(t)}):n(s.$store.state.dicts[e])})},initIdMap:function(t,e){var a=this;return new o.a(function(s,n){var o=t,r=["lessons"],i={lessons:{idf:"lid",txf:"lesson_name"},classes:{idf:"cid",txf:"class_name"},employees:{idf:"eid",txf:"ename"},subjects:{idf:"sj_id",txf:"subject_name"}},c=i[t].idf,m=i[t].txf;-1===r.indexOf(t)&&(o=[t,e].join("-")),a.$store.getters.isCache(o)?s(!0):a.$store.dispatch("initIdMap",{name:t,idf:c,txf:m}).then(function(t){s(t),u.a.set(a.$store.state.cache,o,!0)},function(t){n(t)})})},getDictList:function(t){return this.$store.getters.getDictList(t)},getGlobalVar:function(t){return this.$store.getters.getGlobalVar(t)},multiBranch:function(){this.$store.commit("branchMultiMode")},singleBranch:function(){this.$store.commit("branchSingleMode")},noneBranch:function(){this.$store.commit("branchNoneMode")},getSubjectObj:function(t){var e=this.$store;if(e.state.maps.subject_object||(e.state.maps.subject_object={},e.state.maps.subject={}),e.state.maps.subject_object[t])return e.state.maps.subject_object[t];var a=e.state.gvars.subjects.find(function(e){return e.sj_id==t});return a?(e.state.maps.subject[t]=a.subject_name,e.state.maps.subject_object[t]=a,a):null},getLessonObj:function(t){var e=this.$store;if(e.state.maps.lesson_object||(e.state.maps.lesson_object={},e.state.maps.lesson={}),e.state.maps.lesson_object[t])return e.state.maps.lesson_object[t];var a=e.state.gvars.lessons.find(function(e){return e.lid==t});return a?(e.state.maps.lesson[t]=a.lesson_name,e.state.maps.lesson_object[t]=a,a):null},getClassRoomObj:function(t){var e=this.$store;if(e.state.maps.classroom_object||(e.state.maps.classroom_object={},e.state.maps.classroom={}),e.state.maps.classroom_object[t])return e.state.maps.classroom_object[t];var a=e.state.gvars.classrooms.find(function(e){return e.cr_id==t});return a?(e.state.maps.classroom[t]=a.room_name,e.state.maps.classroom_object[t]=a,a):null},getEmployeeObj:function(t){var e=this.$store;if(e.state.maps.employee_object||(e.state.maps.employee_object={},e.state.maps.employee={}),e.state.maps.employee_object[t])return e.state.maps.employee_object[t];var a=e.state.gvars.employees.find(function(e){return e.eid==t});return a?(e.state.maps.employee[t]=a.ename,e.state.maps.employee_object[t]=a,a):null}},computed:{areas:function(){return this.$store.getters.getGlobalVar("areas")},branchs:function(){return this.$store.getters.getGlobalVar("branchs")},roles:function(){return this.$store.getters.getGlobalVar("roles")},pers:function(){return this.$store.getters.getGlobalVar("pers")},mobile_pers:function(){return this.$store.getters.getGlobalVar("mobile_pers")},configs:function(){return this.$store.getters.getGlobalVar("configs")}}}},446:function(t,e,a){t.exports={default:a(447),__esModule:!0}},447:function(t,e,a){a(448);var s=a(1).Object;t.exports=function(t,e,a){return s.defineProperty(t,e,a)}},448:function(t,e,a){var s=a(6);s(s.S+s.F*!a(10),"Object",{defineProperty:a(9).f})},490:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var n=a(510),o=s(n),r=a(200),i=s(r);e.default=function(){function t(t,e){var a=[],s=!0,n=!1,o=void 0;try{for(var r,c=(0,i.default)(t);!(s=(r=c.next()).done)&&(a.push(r.value),!e||a.length!==e);s=!0);}catch(t){n=!0,o=t}finally{try{!s&&c.return&&c.return()}finally{if(n)throw o}}return a}return function(e,a){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return t(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},510:function(t,e,a){t.exports={default:a(511),__esModule:!0}},511:function(t,e,a){a(32),a(30),t.exports=a(512)},512:function(t,e,a){var s=a(53),n=a(2)("iterator"),o=a(17);t.exports=a(1).isIterable=function(t){var e=Object(t);return void 0!==e[n]||"@@iterator"in e||o.hasOwnProperty(s(e))}},730:function(t,e,a){"use strict";var s=a(490),n=a.n(s),o=a(4);e.a={data:function(){return{cfg_name:"",cfg_id:0,config:{},action:"edit"}},mounted:function(){this.init_config_data()},methods:{init_config_data:function(){var t=this;this.$http.get("configs?cfg_name="+this.cfg_name).then(function(e){if(o.a.isArray(e.body.data)&&0===e.body.data.length)t.action="add";else{0==e.body.data.cfg_id&&(t.action="add");for(var a in e.body.data.cfg_value)t.$set(t.config,a,e.body.data.cfg_value[a]);t.cfg_id=e.body.data.cfg_id}t.initFinished()}).catch(function(e){t.$Message.error(e.message)})},initFinished:function(){},handleSubmit:function(){var t=this,e="add"===this.action?["post","configs"]:["put","configs/"+this.cfg_id],a=n()(e,2),s=a[0],o=a[1],r={cfg_name:this.cfg_name,cfg_value:this.config};this.$http[s](o,r).then(function(e){var a=t.cfg_name;"lesson"==a&&(a="lesson_config"),"params"==a&&(a="configs"),t.$Message.success("保存成功!"),t.$store.dispatch("updateGlobalVar",a),t.init_config_data()}).catch(function(e){t.$Message.error(e.message)})}}}}});