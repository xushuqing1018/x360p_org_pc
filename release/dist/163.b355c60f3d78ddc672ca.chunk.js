webpackJsonp([163],{1801:function(t,e,s){"use strict";var a=s(1),n=s(910),i=s(210);e.a={mixins:[n.a,i.a],data:function(){return{cfg_name:"params",student_leave_unit:"day",student_leave_value:1,loadFinished:!1,config:{org_name:"",sysname:"",address:"",mobile:"",present_lesson_consume_method:1,ignore_time_long_clh:0,remind_before_course:{days_before:1},class_attendance:{min_after_class:10,min_before_class:10,allow_debt_att:0},return_visit:{absence_times:3,ask_leave_times:3,not_hand_in_homework_times:3,student_lesson_remain_times:5,student_lesson_remain_rate:.3},student_leave:{minutes_before:1440,enable:!0},course_arrange:{ignore_1by1_cc:0},student_signup:{allow_modify_date:1,modify_date_days:30},default_sale_role_did:{new:"",renew:""},leave_warn_times:5}}},watch:{student_leave_unit:function(t){""!=t&&this.loadFinished&&this.setStudentLeave(t)},student_leave_value:function(t){this.config.student_leave.minutes_before=t}},computed:{sale_roles:function(){return this.$store.state.gvars.dicts.sale_role}},methods:{initFinished:function(){var t=this;this.student_leave_unit="",this.student_leave_value=this.config.student_leave.minutes_before,this.config.student_leave.minutes_before>=1440?(this.student_leave_unit="day",this.student_leave_value=this.config.student_leave.minutes_before/1440):this.student_leave_unit="min",setTimeout(function(){t.loadFinished=!0},200)},setStudentLeave:function(t){var e=a.b.copy(this.student_leave_value),s=0;s="day"==t?Math.ceil(e/1440):24*e*60,this.student_leave_value=s},getRate:function(){return 100*this.config.return_visit.student_lesson_remain_rate},setRate:function(t){this.config.return_visit.student_lesson_remain_rate=parseFloat(t/100).toFixed(2)},changeLessonConfig:function(){var t=this.config.return_visit.student_lesson_remain_times>0?0:5;this.config.return_visit.student_lesson_remain_times=t}}}},2696:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-grid"},[s("Card",{attrs:{"dis-hover":""}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("系统参数")]),t._v(" "),s("Form",{attrs:{"label-width":120}},[s("Form-item",{staticClass:"mb-0",attrs:{label:"系统参数配置"}}),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:""}},[s("div",[s("label",{staticClass:"mr-3"},[t._v("机构名称")]),t._v(" "),s("Input",{staticStyle:{width:"380px"},attrs:{placeholder:"机构名称"},model:{value:t.config.org_name,callback:function(e){t.$set(t.config,"org_name",e)},expression:"config.org_name"}})],1),t._v(" "),s("div",[s("label",{staticClass:"mr-3"},[t._v("机构地址")]),t._v(" "),s("Input",{staticStyle:{width:"380px"},attrs:{placeholder:"机构地址"},model:{value:t.config.address,callback:function(e){t.$set(t.config,"address",e)},expression:"config.address"}})],1),t._v(" "),s("div",[s("label",{staticClass:"mr-3"},[t._v("联系电话")]),t._v(" "),s("Input",{staticStyle:{width:"380px"},attrs:{placeholder:"联系电话"},model:{value:t.config.mobile,callback:function(e){t.$set(t.config,"mobile",e)},expression:"config.mobile"}})],1)]),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"课程班级参数"}}),t._v(" "),s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[s("label",{directives:[{name:"help",rawName:"v-help",value:"开启后创建班级必须选择所属课程",expression:"'开启后创建班级必须选择所属课程'"}],staticClass:"mr-3"},[t._v("班级必须属于课程")]),t._v(" "),s("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.config.class_must_sel_lesson,callback:function(e){t.$set(t.config,"class_must_sel_lesson",e)},expression:"config.class_must_sel_lesson"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1),t._v(" "),s("div",{staticClass:"mb-2"},[s("label",{directives:[{name:"help",rawName:"v-help",value:"开启后年级班级排课考勤课耗等会有年级条件",expression:"'开启后年级班级排课考勤课耗等会有年级条件'"}],staticClass:"mr-3"},[t._v("是否启用年级")]),t._v(" "),s("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.config.enable_grade,callback:function(e){t.$set(t.config,"enable_grade",e)},expression:"config.enable_grade"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1)]),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"默认课时定义"}}),t._v(" "),t.config.class_attendance?s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t1个课时价格\n\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:0},model:{value:t.config.per_lesson_hour_price,callback:function(e){t.$set(t.config,"per_lesson_hour_price",e)},expression:"config.per_lesson_hour_price"}}),t._v("\n\t\t    \t\t\t元\n\t\t    \t\t")],1),t._v(" "),s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t单课时分钟数\n\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:0},model:{value:t.config.per_lesson_hour_minutes,callback:function(e){t.$set(t.config,"per_lesson_hour_minutes",e)},expression:"config.per_lesson_hour_minutes"}}),t._v("\n\n\t\t    \t\t\t分钟\n\t\t    \t\t")],1),t._v(" "),s("div",{staticClass:"mb-2"},[s("label",{staticClass:"mr-3"},[t._v("是否忽略课时长度与扣课时关系")]),t._v(" "),s("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.config.ignore_time_long_clh,callback:function(e){t.$set(t.config,"ignore_time_long_clh",e)},expression:"config.ignore_time_long_clh"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("开")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("关")])])],1)]):t._e(),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"课前提醒"}}),t._v(" "),t.config.remind_before_course?s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[t._v("\n\t\t\t\t\t\t默认筛选\n\t\t\t\t\t\t"),s("RadioGroup",{staticClass:"ml-3 mr-3",attrs:{type:"button"},model:{value:t.config.remind_before_course.days_before,callback:function(e){t.$set(t.config.remind_before_course,"days_before",e)},expression:"config.remind_before_course.days_before"}},[s("Radio",{attrs:{label:0}},[t._v("今天")]),t._v(" "),s("Radio",{attrs:{label:1}},[t._v("明天")]),t._v(" "),s("Radio",{attrs:{label:2}},[t._v("后天")]),t._v(" "),s("Radio",{attrs:{label:3}},[t._v("大后天")])],1),t._v("\n\t\t    \t\t\t上课的学员\n\t\t    \t\t")],1)]):t._e(),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"点名考勤"}}),t._v(" "),t.config.class_attendance?s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t上课前\n\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:1},model:{value:t.config.class_attendance.min_before_class,callback:function(e){t.$set(t.config.class_attendance,"min_before_class",e)},expression:"config.class_attendance.min_before_class"}}),t._v("\n\t\t    \t\t\t分钟之内可以考勤\n\t\t    \t\t")],1),t._v(" "),s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t下课后\n\t\t    \t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:1},model:{value:t.config.class_attendance.min_after_class,callback:function(e){t.$set(t.config.class_attendance,"min_after_class",e)},expression:"config.class_attendance.min_after_class"}}),t._v("\n\t\t    \t\t\t分钟内可以考勤\n\t\t    \t\t")],1),t._v(" "),s("div",{staticClass:"mb-2"},[s("label",{directives:[{name:"help",rawName:"v-help",value:"开启后学员剩余课时不足时仍可以考勤",expression:"'开启后学员剩余课时不足时仍可以考勤'"}],staticClass:"mr-3"},[t._v("是否允许负课时考勤")]),t._v(" "),s("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.config.class_attendance.allow_debt_att,callback:function(e){t.$set(t.config.class_attendance,"allow_debt_att",e)},expression:"config.class_attendance.allow_debt_att"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("开")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("关")])])],1)]):t._e(),t._v(" "),s("Form-item",{directives:[{name:"help",rawName:"v-help",value:"学员通过学习管家请假",expression:"'学员通过学习管家请假'"}],staticClass:"mb-0",attrs:{label:"学员请假"}}),t._v(" "),s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[s("label",{staticClass:"mr-3"},[t._v("是否允许请假")]),t._v(" "),s("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.config.student_leave.enable,callback:function(e){t.$set(t.config.student_leave,"enable",e)},expression:"config.student_leave.enable"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("开")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("关")])])],1),t._v(" "),t.config.student_leave.enable?s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t至少提前　\n\t\t    \t\t\t"),s("InputNumber",{attrs:{min:1,step:1},model:{value:t.student_leave_value,callback:function(e){t.student_leave_value=e},expression:"student_leave_value"}}),t._v(" "),s("Select",{staticStyle:{display:"inline-block",width:"60px"},model:{value:t.student_leave_unit,callback:function(e){t.student_leave_unit=e},expression:"student_leave_unit"}},[s("Option",{attrs:{value:"day"}},[t._v("天")]),t._v(" "),s("Option",{attrs:{value:"min"}},[t._v("分钟")])],1),t._v("\n\t\t    \t\t\t请假 \n\t\t    \t\t")],1):t._e(),t._v(" "),t.config.student_leave.enable?s("div",{staticClass:"mb-2"},[s("span",{directives:[{name:"help",rawName:"v-help",value:"同一课程允许请假的次数限制",expression:"'同一课程允许请假的次数限制'"}]},[t._v("允许请假 ")]),t._v(" "),s("Input",{directives:[{name:"keeptwo",rawName:"v-keeptwo"}],staticStyle:{width:"70px"},attrs:{size:"small"},model:{value:t.config.student_leave.times_limit,callback:function(e){t.$set(t.config.student_leave,"times_limit",e)},expression:"config.student_leave.times_limit"}}),t._v("\n\t\t    \t\t\t 次 "),s("span",{staticStyle:{color:"#f60"}},[t._v("(0为不限制请假次数)")])],1):t._e()]),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"排课"}}),t._v(" "),s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[s("label",{staticClass:"mr-3"},[t._v("忽略1对1排课教室冲突")]),t._v(" "),s("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.config.course_arrange.ignore_1by1_cc,callback:function(e){t.$set(t.config.course_arrange,"ignore_1by1_cc",e)},expression:"config.course_arrange.ignore_1by1_cc"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("开")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("关")])])],1)]),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"请假预警"}}),t._v(" "),s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t预警请假\n\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:1},model:{value:t.config.leave_warn_times,callback:function(e){t.$set(t.config,"leave_warn_times",e)},expression:"config.leave_warn_times"}}),t._v("\n\t\t    \t\t\t次以上的学员\n\t\t    \t\t")],1)]),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"学员回访"}}),t._v(" "),t.config.return_visit?s("Form-item",{staticClass:"mb-0"},[s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t显示请假\n\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:1},model:{value:t.config.return_visit.ask_leave_times,callback:function(e){t.$set(t.config.return_visit,"ask_leave_times",e)},expression:"config.return_visit.ask_leave_times"}}),t._v("\n\t\t    \t\t\t次以上的学员\n\t\t    \t\t")],1),t._v(" "),s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t显示缺勤\n\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:1},model:{value:t.config.return_visit.absence_times,callback:function(e){t.$set(t.config.return_visit,"absence_times",e)},expression:"config.return_visit.absence_times"}}),t._v("\n\t\t    \t\t\t显示次以上的学员\n\t\t    \t\t")],1),t._v(" "),s("div",{staticClass:"mb-2"},[t._v("\n\t\t    \t\t\t显示未交作业\n\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:1},model:{value:t.config.return_visit.not_hand_in_homework_times,callback:function(e){t.$set(t.config.return_visit,"not_hand_in_homework_times",e)},expression:"config.return_visit.not_hand_in_homework_times"}}),t._v("\n\t\t    \t\t\t次以上的学员\n\t\t    \t\t")],1),t._v(" "),s("div",{staticClass:"mb-2"},[t.config.return_visit.student_lesson_remain_times?[t._v("\n\t\t\t    \t\t\t显示剩余课次总量\n\t\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3 mr-3",attrs:{min:0},model:{value:t.config.return_visit.student_lesson_remain_times,callback:function(e){t.$set(t.config.return_visit,"student_lesson_remain_times",e)},expression:"config.return_visit.student_lesson_remain_times"}})]:[t._v("\n\t\t    \t\t\t\t显示剩余课次百分比\n\t\t\t    \t\t\t"),s("InputNumber",{staticClass:"ml-3",attrs:{value:t.getRate(),step:10,min:0,max:100},on:{"on-change":t.setRate}}),t._v(" "),s("span",{staticClass:"mr-3"},[t._v("%")])],t._v(" "),s("Button",{staticClass:"ml-3",attrs:{type:"ghost",icon:"arrow-swap"},on:{click:t.changeLessonConfig}},[t._v("更换条件")])],2)]):t._e(),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"赠送课时消耗规则"}}),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:""}},[s("RadioGroup",{model:{value:t.config.present_lesson_consume_method,callback:function(e){t.$set(t.config,"present_lesson_consume_method",e)},expression:"config.present_lesson_consume_method"}},[s("Radio",{attrs:{label:1}},[t._v("1、先消耗正常课次，再消耗赠送课次。")]),t._v(" "),s("Radio",{attrs:{label:2}},[t._v("2、按平均单价计算。")]),t._v(" "),s("Radio",{attrs:{label:3}},[t._v("3、先消耗赠送课次，再消耗正常课次。")])],1)],1),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"报名缴费日期"}}),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:""}},[s("div",[s("label",{staticClass:"mr-3"},[t._v("是否允许修改")]),t._v(" "),s("i-switch",{attrs:{"true-value":1,"false-value":0},model:{value:t.config.student_signup.allow_modify_date,callback:function(e){t.$set(t.config.student_signup,"allow_modify_date",e)},expression:"config.student_signup.allow_modify_date"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1),t._v(" "),t.config.student_signup.allow_modify_date?s("div",[s("label",{staticClass:"mr-3"},[t._v("允许范围，当前日期(含)往前推")]),t._v(" "),s("InputNumber",{staticClass:"mr-3",attrs:{min:1},model:{value:t.config.student_signup.modify_date_days,callback:function(e){t.$set(t.config.student_signup,"modify_date_days",e)},expression:"config.student_signup.modify_date_days"}}),t._v("\n\t\t    \t\t\t天\n\t\t    \t\t")],1):t._e()]),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:"默认业绩归属人销售角色","label-width":150}}),t._v(" "),s("Form-item",{staticClass:"mb-0",attrs:{label:""}},[s("div",[s("label",{staticClass:"mr-3"},[t._v("新生报名")]),t._v(" "),s("Select",{staticStyle:{width:"200px"},model:{value:t.config.default_sale_role_did.new,callback:function(e){t.$set(t.config.default_sale_role_did,"new",e)},expression:"config.default_sale_role_did.new"}},t._l(t.sale_roles,function(e){return s("Option",{attrs:{value:e.did}},[t._v(t._s(e.name))])}))],1),t._v(" "),s("div",[s("label",{staticClass:"mr-3"},[t._v("老生续报")]),t._v(" "),s("Select",{staticStyle:{width:"200px"},model:{value:t.config.default_sale_role_did.renew,callback:function(e){t.$set(t.config.default_sale_role_did,"renew",e)},expression:"config.default_sale_role_did.renew"}},t._l(t.sale_roles,function(e){return s("Option",{attrs:{value:e.did}},[t._v(t._s(e.name))])}))],1)])],1)],1),t._v(" "),s("div",{staticClass:"mt-3 footer-btn",staticStyle:{"padding-left":"0"}},[s("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit()}}},[t._v("保存配置")])],1)],1)},n=[];a._withStripped=!0;var i={render:a,staticRenderFns:n};e.a=i},525:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(1801),n=s(2696),i=s(11),l=i(a.a,n.a,!1,null,null,null);l.options.__file="src/views/system/configs/params.vue",e.default=l.exports},602:function(t,e,s){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var n=s(611),i=a(n),l=s(212),o=a(l);e.default=function(){function t(t,e){var s=[],a=!0,n=!1,i=void 0;try{for(var l,_=(0,o.default)(t);!(a=(l=_.next()).done)&&(s.push(l.value),!e||s.length!==e);a=!0);}catch(t){n=!0,i=t}finally{try{!a&&_.return&&_.return()}finally{if(n)throw i}}return s}return function(e,s){if(Array.isArray(e))return e;if((0,i.default)(Object(e)))return t(e,s);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},611:function(t,e,s){t.exports={default:s(612),__esModule:!0}},612:function(t,e,s){s(36),s(27),t.exports=s(613)},613:function(t,e,s){var a=s(56),n=s(4)("iterator"),i=s(18);t.exports=s(2).isIterable=function(t){var e=Object(t);return void 0!==e[n]||"@@iterator"in e||i.hasOwnProperty(a(e))}},910:function(t,e,s){"use strict";var a=s(602),n=s.n(a),i=s(1);e.a={data:function(){return{cfg_name:"",cfg_id:0,config:{},action:"edit"}},mounted:function(){this.init_config_data()},methods:{init_config_data:function(){var t=this;this.$http.get("configs?cfg_name="+this.cfg_name).then(function(e){if(i.a.isArray(e.body.data)&&0===e.body.data.length)t.action="add";else{0==e.body.data.cfg_id&&(t.action="add");for(var s in e.body.data.cfg_value)t.$set(t.config,s,e.body.data.cfg_value[s]);t.cfg_id=e.body.data.cfg_id}t.initFinished()}).catch(function(e){t.$Message.error(e.message)})},initFinished:function(){},handleSubmit:function(){var t=this,e="add"===this.action?["post","configs"]:["put","configs/"+this.cfg_id],s=n()(e,2),a=s[0],i=s[1],l={cfg_name:this.cfg_name,cfg_value:this.config};this.$http[a](i,l).then(function(e){var s=t.cfg_name;"lesson"==s&&(s="lesson_config"),"params"==s&&(s="configs"),t.$Message.success("保存成功!"),t.$store.dispatch("updateGlobalVar",s),t.init_config_data()}).catch(function(e){t.$Message.error(e.message)})},restoreDefault:function(){var t=this;this.confirm("你确定恢复默认的菜单设置吗？").then(function(){t.$rest("configs").delete(t.cfg_id).success(function(e){t.$Message.success("恢复成功"),t.init_config_data()}).error(function(e){t.$Message.error(e.body.message)})})}}}}});