webpackJsonp([183],{1429:function(e,t,i){"use strict";var n=i(1),s=i(211),a=i(209),l={business_type:"",name:"",tpl_id:"",tpl_define:{first:["","#000000"],data:[],remark:["","#000000"]}};t.a={name:"wechatInfoModal",mixins:[s.a,a.a],data:function(){return{info:n.b.copy(l),canChange:!1,define:{field:"{{keyword1.DATA}}",label:"",value:"",color:"#000000"},action:"add",rules:{name:[{required:!0,type:"string",message:"请输入模板名称",trigger:"blur"}],template_id:[{required:!0,type:"string",message:"请输入模板ID",trigger:"blur"}]}}},methods:{selectVar:function(e){this.define.value=e},saveDefine:function(){if(""===this.define.key||""===this.define.value)return!1;this.info.tpl_define.data.push(this.define),this.define={label:"",value:"",color:"#000000"},this.action=""},addDefine:function(){var e=this.info.tpl_define.data.length+1;this.define.field="{{keyword"+e+".DATA}}",this.action="add"},delDefine:function(e){this.info.tpl_define.data.splice(e,1);var t=this.info.tpl_define.data.length+1;this.define.field="{{keyword"+t+".DATA}}";for(var i=0,n=this.info.tpl_define.data.length;i<n;i++){var s=this.info.tpl_define.data[i],a=i+1;s.field="{{keyword"+a+".DATA}}"}},ok:function(){return""===this.info.name?(this.$Message.error("模板名称不能为空"),!1):""===this.info.template_id?(this.$Message.error("模板ID不能为空"),!1):""===this.info.tpl_define.first[0]?(this.$Message.error("请填充模板{{first.DATA}}的值"),!1):0==this.info.tpl_define.data.length?(this.$Message.error("请添加一条键"),!1):""===this.info.tpl_define.remark[0]?(this.$Message.error("请填充模板{{remark.DATA}}的值"),!1):void this.save()}},watch:{"modal$.show":function(e){e&&"add"==this.modal$.action&&(this.info=n.b.copy(l))}},computed:{info_url$:function(){return"wechat_tpl_defines"},info_name$:function(){return"短信模板"},info_pk_id$:function(){return"wtd_id"},remark_place:function(){return"{{remark.DATA}}"},first_place:function(){return"{{first.DATA}}"},sms_tpl_vars:function(){var e=this,t=[],i=this.sms_tpls.find(function(t){return t.business_type==e.info.business_type});return i&&(t=i.vars),t},sms_tpls:function(){return this.$store.state.gvars.sms_tpls}}}},1938:function(e,t){},1939:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{directives:[{name:"drag-modal",rawName:"v-drag-modal"}],attrs:{"mask-closable":!1,width:"750",title:e.modal$.title},on:{"on-cancel":e.close},model:{value:e.modal$.show,callback:function(t){e.$set(e.modal$,"show",t)},expression:"modal$.show"}},[e.modal$.show?[i("Form",{ref:"form",staticClass:"wechat-tpl-info pr-4 mr-4",attrs:{"label-width":100,model:e.info}},[i("Form-item",{attrs:{prop:"business_type",label:"业务类型"}},[i("Select",{attrs:{placeholder:"请选择业务类型"},model:{value:e.info.business_type,callback:function(t){e.$set(e.info,"business_type",t)},expression:"info.business_type"}},[i("Option",{attrs:{value:""}},[e._v("不限")]),e._v(" "),e._l(e.sms_tpls,function(t){return i("Option",{attrs:{value:t.business_type}},[e._v(e._s(t.name))])})],2)],1),e._v(" "),i("Form-item",{staticClass:"define",attrs:{label:"模板名称"}},[i("Input",{attrs:{placeholder:"模板名称，例：订单完成模板 (自定义)"},model:{value:e.info.name,callback:function(t){e.$set(e.info,"name",t)},expression:"info.name"}})],1),e._v(" "),i("Form-item",{staticClass:"define",attrs:{label:"模板消息ID"}},[i("Input",{attrs:{placeholder:"微信模板ID,例:47KVWOqduxGHwJ8HnxCRSr4KoUmaMKUnvkvjxoVMU7M"},model:{value:e.info.tpl_id,callback:function(t){e.$set(e.info,"tpl_id",t)},expression:"info.tpl_id"}})],1),e._v(" "),i("Form-item",{staticClass:"define",attrs:{label:"头部标题"}},[i("Input",{staticStyle:{width:"85%"},attrs:{placeholder:e.first_place},model:{value:e.info.tpl_define.first[0],callback:function(t){e.$set(e.info.tpl_define.first,0,t)},expression:"info.tpl_define.first[0]"}}),e._v(" "),i("ColorPicker",{attrs:{recommend:""},model:{value:e.info.tpl_define.first[1],callback:function(t){e.$set(e.info.tpl_define.first,1,t)},expression:"info.tpl_define.first[1]"}})],1),e._v(" "),i("Form-item",{staticClass:"define",attrs:{label:"自定义键"}},[i("div",{staticClass:"row",staticStyle:{"margin-left":"0"}},[i("table",{staticClass:"col-sm-9"},[i("tbody",[i("tr",[i("td",[e._v("变量名")]),e._v(" "),i("td",[e._v("标签")]),e._v(" "),i("td",[e._v("键值")]),e._v(" "),i("td",[e._v("操作")])]),e._v(" "),e._l(e.info.tpl_define.data,function(t,n){return i("tr",[i("td",[e._v(e._s(t.field))]),e._v(" "),i("td",[e._v(e._s(t.label))]),e._v(" "),i("td",[i("div",{style:{color:t.color}},[e._v(e._s(t.value))])]),e._v(" "),i("td",[i("Button",{attrs:{type:"text",size:"small",icon:"minus-circled",title:"删除"},on:{click:function(t){e.delDefine(n)}}})],1)])}),e._v(" "),"add"==e.action?i("tr",[i("td",[e._v(e._s(e.define.field))]),e._v(" "),i("td",[i("Input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"标签"},model:{value:e.define.label,callback:function(t){e.$set(e.define,"label",t)},expression:"define.label"}})],1),e._v(" "),i("td",[i("Input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"键值"},model:{value:e.define.value,callback:function(t){e.$set(e.define,"value",t)},expression:"define.value"}}),e._v(" "),i("ColorPicker",{attrs:{size:"small",recommend:""},model:{value:e.define.color,callback:function(t){e.$set(e.define,"color",t)},expression:"define.color"}})],1),e._v(" "),i("td",[i("Button",{attrs:{type:"text",size:"small",icon:"checkmark",title:"保存"},on:{click:e.saveDefine}})],1)]):i("tr",[i("td",{staticClass:"text-center",attrs:{colspan:"3"}},[i("Button",{attrs:{type:"text",size:"small",icon:"plus"},on:{click:e.addDefine}},[e._v("添加\n\t        \t\t\t\t\t\t\t")])],1)])],2)]),e._v(" "),i("div",{staticClass:"define-vars col-sm-3"},[e.sms_tpl_vars.length>0?i("Card",{attrs:{"dis-hover":""}},[i("span",{attrs:{slot:"title"},slot:"title"},[e._v("选择模板变量：")]),e._v(" "),e._l(e.sms_tpl_vars,function(t){return i("Tag",{nativeOn:{click:function(i){e.selectVar(t)}}},[e._v(e._s(t))])})],2):e._e()],1)])]),e._v(" "),i("Form-item",{staticClass:"define",attrs:{label:"尾部描述"}},[i("Input",{staticStyle:{width:"85%"},attrs:{placeholder:e.remark_place},model:{value:e.info.tpl_define.remark[0],callback:function(t){e.$set(e.info.tpl_define.remark,0,t)},expression:"info.tpl_define.remark[0]"}}),e._v(" "),i("ColorPicker",{attrs:{recommend:""},model:{value:e.info.tpl_define.remark[1],callback:function(t){e.$set(e.info.tpl_define.remark,1,t)},expression:"info.tpl_define.remark[1]"}})],1)],1)]:e._e(),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"ghost"},on:{click:e.close}},[e._v("取消")]),e._v(" "),i("Button",{attrs:{type:"primary"},on:{click:e.ok}},[e._v("确定")])],1)],2)},s=[];n._withStripped=!0;var a={render:n,staticRenderFns:s};t.a=a},400:function(e,t,i){"use strict";function n(e){l||i(1938)}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1429),a=i(1939),l=!1,o=i(11),r=n,d=o(s.a,a.a,!1,r,null,null);d.options.__file="src/views/system/configs/wechat/info-modal.vue",t.default=d.exports}});